# LAMMPS input file

units 	 lj 
atom_style angle
boundary 	 s s s

read_data 	 polymer50.data extra/bond/per/atom 50 extra/special/per/atom 50

# interactions 

pair_style zero 1
pair_coeff * *

bond_style 	 harmonic 
bond_coeff 	 * 50 1.0 

angle_style harmonic
angle_coeff * 2.5 180.0

group left_bead id 1 
group right_bead id 50
group endsbeads id 1 50

# Equilibration

timestep 	 0.05 
velocity 	 all create 1.0 ${seed} rot yes dist gaussian 

thermo 	 10000 
thermo_style 	 custom step time etotal temp press vol 

fix left_force left_bead addforce -1.0 0.0 0.0
fix right_force right_bead addforce 1.0 0.0 0.0

fix ini_temp 	 all nve/limit $(100.0*dt) 
fix Lang_dyn all langevin 1 1 1 ${seed}

run 	 100000

unfix ini_temp 
unfix Lang_dyn 

# Main simulation

reset_timestep 0
timestep 0.005

fix post_Lang_dyn2 all ffl 1 1 1 ${seed}

dump  dump_final endsbeads xyz 1000 distances.${seed}.txt


run 	 1000000000


print "ALL DONE"

write_data 	 system.data
