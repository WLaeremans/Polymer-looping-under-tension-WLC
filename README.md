# Polymer-looping-under-tension-WLC
Code and data used for publication in Physical Review Research: "Theoretical models for tension-dependent DNA looping time", by Wout Laeremans and Wouter G. Ellenbroek.

## LAMMPS
The main LAMMPS file is main.lmp, which contains the code for a semiflexible chain polymer under tension and outputs the timestep at which a loop is formed (i.e., when the two outermost beads come within a capture distance $r_\mathrm{c}$). In the uploaded example, the polymer consists of 50 beads (so $N = 49$ is the number of bonds), and the corresponding data file is polymer50.data. The bond length $b$ is set to 1.0 and can be changed in line 15. The force $f$ is set to 1.0 as well and can be changed in lines 31-32. This file can be easily adapted to simulate a different number of beads, as well as other parameters used in the example.

The files rxn_pre.data_template, rxn_post.data_template, and rxn.map are included to determine when a loop is formed. For this, we use the REACTER package and define a reaction when the two outermost beads come within the capture distance $r_\mathrm{c}$. This reaction is implemented in lines 50â€“52 of main.lmp. In this example, the capture distance is set to $r_\mathrm{c} = 1.0$. To change it, modify the 1.0 on line 51 to the desired value. Note that a larger capture distance may require small changes to both the main script and data file. These are explained in: https://github.com/WLaeremans/Polymer-looping-under-tension-FJC-

Additionally, this reaction setup requires that the two outermost beads on each end of the polymer are of type 2 and 3 on the upper side, and type 3 and 2 on the lower side, as specified in the example file polymer50.data.

To enable output of the exact timestep when a loop forms, we slightly modified the LAMMPS source code. Specifically, we changed fix_bond_react.cpp as shown in this commit: https://github.com/wouterel/lammps/commit/314e9ca4e797eabb391b2d5b575cb6f5e259d4e0. With this modification, main.lmp prints the exact timestep at which a loop is formed.

## MATLAB
For the MATLAB code, MATLAB R2023a was used. The first code "comparison_experiment.m" reproduces Fig. 2 in the article. The second code "3_theories.m" reproduces Fig. 3 in the article and requires the data in the zip-file "data_WLC_3_theories.zip". In order for the code to work, the data in this folder should be added to the main path. The data files are named as follows: "Nx_fy.txt", where x represents the value of N (where there are N+1 beads) and y is the value of the force. For every file, there are 100 timesteps, as for every combination of N and f, 100 simulations with a different seed were performed. The third code "zero_force_scaling.m" reproduces Fig. 4 in the article and requires the data in the zip-file "data_zero_force_scaling.zip". Here to, the data in the folder should be added to the main path. The naming is "Lx.txt", where x is again the value of N. However, since the bond length b = 1, this is also the length L. Finally, the fourth code "finite_size.m" reproduces Fig. 5 in the article and requires the data in the zip-file "data_finite_size.zip". For N = 11, the data is the same as in data_WLC_3_theories.zip. However, in data_finite_size.zip, data is added of the form N22_fy_fse.txt, where y again gives the force. Where for N = 11, the bond length was b = 1, for N = 22, b = 0.5. However, the value of kappa (the bending stiffness) was doubled for N = 22, such that these two case of N = 11 and N = 22 represent the same polymer. Again, in order to run "finite_size.m", one should add the data folder to the main path.
