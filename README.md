# Polymer-looping-under-tension-WLC
Code and data used for preprint: "Polymer dynamics under tension: mean first passage time for looping", by Wout Laeremans and Wouter G. Ellenbroek.

## LAMMPS
The main LAMMPS file is main.lmp, which contains the code for a wormlike chain of semiflexible chain polymer under tension and outputs the timestep at which is formed a loop (two most outer beads as close as some capture distance r_c). In the example uploaded, the polymer contains 50 beads (so N = 49), and the corresponding data file is given in polymer50.data. This file can be easily adapted to simulate a different number of beads, similar to the other parameters in this example. The files rxn_pre.data_template, rxn_post.data_template and rxn.map are only included to check when a loop is formed. For this, we used the REACTER package and define a reaction when the two outer points of the polymer are as close as the capture distance. This reaction is implemented in lines 50-52. In this example, the capture distance is set to r_c = 1.0, and to change it one should change the 1.0 on line 51 to the desired distance. However, note that a bigger capture distance might require to make a small change in the main and data file. The necessary changes are explained in: https://github.com/WLaeremans/Polymer-looping-under-tension-FJC-.git. Furthermore, this reaction requires the two most outer beads on every side of the polymer to be type 2 and 3 on the upper side and type 3 and 2 on the bottom side, as is the case in the example file polymer50.data. In order for the code to output the timestep, we have slightly changed the LAMMPS source code. We changed fix_bond_react.cpp as follows: https://github.com/wouterel/lammps/commit/314e9ca4e797eabb391b2d5b575cb6f5e259d4e0. With this fix, main.lmp prints the exact timestep a loop is formed.

## MATLAB
For the MATLAB code, MATLAB R2023a was used. The first code "comparison_experiment.m" reproduces Fig. 2 in the article. The second code "3_theories.m" reproduces Fig. 3 in the article and requires the data in the zip-file "data_WLC_3_theories.zip". In order for the code to work, the data in this folder should be added to the main path. The third code "zero_force_scaling.m" reproduces Fig. 4 in the article and requires the data in the zip-file "data_zero_force_scaling.zip". Here to, the data in the folder should be added to the main path. 
